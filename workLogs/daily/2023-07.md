## 工作内容

## 难题
- scroll-view 套 scroll-view 里面的滚动高度。置顶功能
  - 解答：通过直接设置底部元素的高度，实现置顶功能，滑倒底部，开启内部 scroll-view 的下滑，当上滑后，禁用内部 scroll-view 的下滑。
  - 问题：通过 lower-threshold 设置一个触发滑倒底的阀值，去设置内部 scroll-view 的滚动，有时候在滑动太快的时候，不触发 scrolltolower。
    - 解答：在 scroll 事件中，添加一个 setTimeout 获取元素滚动的 px 高度，去计算是否滑动到底部。
    ``` ts
      const timeoutId = ref<number>()
      const isScrollLower = () => {
        if (timeoutId.value) {
          clearTimeout(timeoutId.value)
        }

        timeoutId.value = setTimeout(() => {
          const query = uni.createSelectorQuery().in(instance)
          query.select('.circle-detail-view').scrollOffset() // 最外侧 scroll-view
          query.exec((res) => {
            const scrollLength = Math.ceil(res[0].scrollTop)
            if (scrollY.value) {
              if (scrollTop.value >= scrollLength) {
                scrollY.value = false
              }
            }

            scrollTop.value = scrollLength
            // allowOffsetHeight 需要自己计算允许滚动的高度
            scrollY.value = Math.abs(res[0].scrollTop - allowOffsetHeight) <= 2
          })
        }, 200)
      }
    ```
- swiper 滚动卡顿问题
  - 解答：卡友圈首页 video 更换为 image - 问题解决
- 没有 provide , inject 注入报错
- 虚拟滚动 https://ext.dcloud.net.cn/plugin?id=8732
- 小程序 拉起 app

## 心得
- 主动推动项目的进度。
- 项目排期要有理有据，那些难点，需要干什么，花费多少时间，项目现在的进度到哪里，都需要把控。
- 卡友圈首页添加了很多 video 导致页面滑动卡顿，更换为图片 - 问题解决
## 记录