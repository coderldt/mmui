# 性能优化专场

## 首屏加载优化

### 思路
什么原因导致首屏加载慢
- 网络延迟
- 资源太大

网络延迟
- cdn 就近节点
- proload
- prerender

资源太大
- 包 thunk
- 懒加载
- 公共资源 vender
- 缓存
  - 强缓存，公共资源不变的那种，vener，我们的依赖
  - 协商缓存，我们每次更新迭代后打包的js文件
  - 策略缓存
- 服务端渲染
- 局部 ssr（落地页，广告页，营销活动页）
- pwa

### 指标衡量
- FP first paint
- FCP first contentful paint

performance

- FMP first meaningful paint
- LCP largest contentful paint

mutation observer

### 具体优化细节
- 优化图片：推荐 webp 格式，不用太大的图片，根据需求定大小，头像控制在 200*200
- 延迟加载：xxx，滚动加载，可视区内容渲染
- trre-shaking: 基本打包工具都自带，通过代码编写的方式去约定，需要esm（模块化--amd,cmd,umd,commonjs, esm）
- cdn
- 精简三方库
  - 库内容要支持按需导入 babel-plugin-import
  - dayjs 文件 国际化文件移除，你只需要中文，其他的移除
- 缓存
- 字体压缩 font-spider 移除无用字体， webfont 处理字体加载

### 具体实现的进阶
- 预加载：preload
``` html
  <link rel="preload" href="xxx.js" >
```

- 加载关键css
将关键的css 关键提取出来，通过 webpack 提取出来，内联的插入到节点里面

- 延迟加载
 defer async

- 预渲染
prerender

webpack prerender
@prerender/webpack-plugin

vite 测试工具 vite-bundle-analyzer 查看包具体有多大
